--- a/io/hpmud/musb.c
+++ b/io/hpmud/musb.c
@@ -689,7 +689,8 @@
 	int numdevs = 0;        /* number of connected devices */
 	int i, conf, iface, altset ;
 
-	libusb_init(&libusb_ctx);
+	i = libusb_init(&libusb_ctx);
+	if (i) goto bugout;
 	numdevs = libusb_get_device_list(libusb_ctx, &libusb_dev_list);
 	for (i=0; i< numdevs; i++)
 	{
@@ -2033,7 +2034,8 @@
 	char serial[128], mfg[128], sz[HPMUD_LINE_SIZE];
 	int r, size=0;
 
-	libusb_init(&ctx);
+	i = libusb_init(&ctx);
+	if (i) goto bugout;
 	numdevs = libusb_get_device_list(ctx, &list);
 
 	if (numdevs <= 0)
@@ -2129,12 +2131,14 @@
 	}//end for loop
 
 bugout:
-	if (!hd)
+	if (hd)
 		libusb_close(hd);
 	if (confptr)
 		libusb_free_config_descriptor(confptr);
-	libusb_free_device_list(list, 1);
-	libusb_exit(ctx);
+	if (list)
+		libusb_free_device_list(list, 1);
+	if (ctx)
+		libusb_exit(ctx);
 
 	return size;
 }
@@ -2160,7 +2164,8 @@
 
 	*bytes_read=0;
 
-	libusb_init(&ctx);
+	i = libusb_init(&ctx);
+	if (i) goto bugout;
 	numdevs = libusb_get_device_list(ctx, &list);
 
 	if (numdevs <= 0)
@@ -2263,8 +2268,10 @@
 	if (hd != NULL)
 		libusb_close(hd);
 
-	libusb_free_device_list(list, 1);
-	libusb_exit(ctx);
+	if (list)
+		libusb_free_device_list(list, 1);
+	if (ctx)
+		libusb_exit(ctx);
 
 	return stat;
 }
@@ -2283,7 +2290,8 @@
 
 	*bytes_read=0;
 
-	libusb_init(&ctx);
+	i = libusb_init(&ctx);
+	if (i) goto bugout;
 	numdevs = libusb_get_device_list(ctx, &list);
 
 	if (numdevs <= 0)
@@ -2309,8 +2317,10 @@
 	stat = HPMUD_R_OK;
 
 bugout:
-	libusb_free_device_list(list, 1);
-	libusb_exit(ctx);
+	if (list)
+		libusb_free_device_list(list, 1);
+	if (ctx)
+		libusb_exit(ctx);
 
 	return stat;
 }
