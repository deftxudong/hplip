Description: Fix insecure temporary files handling in pkit.py
Origin: vendor 
Bug-Debian: http://bugs.debian.org/725876
Bug-RedHat: https://bugzilla.redhat.com/show_bug.cgi?id=1035243
Bug-SuSE: https://bugzilla.novell.com/show_bug.cgi?id=852368
Bug-Gentoo: https://bugs.gentoo.org/show_bug.cgi?id=492712
Author: Moritz Muehlenhoff <jmm@debian.org> 
Last-Update: 2014-01-12

diff -aur hplip-3.12.6.orig/base/pkit.py hplip-3.12.6/base/pkit.py
--- hplip-3.12.6.orig/base/pkit.py	2012-06-18 12:44:13.000000000 +0200
+++ hplip-3.12.6/base/pkit.py	2013-12-10 13:04:22.916674893 +0100
@@ -29,6 +29,7 @@
 import ConfigParser
 import shutil
 import stat
+import tempfile
 
 # Local
 from base.logger import *
@@ -205,7 +206,7 @@
     class BackendService(PolicyKitService):
         INTERFACE_NAME = 'com.hp.hplip'
         SERVICE_NAME   = 'com.hp.hplip'
-        LOGFILE_NAME   = '/tmp/hp-pkservice.log'
+        LOGFILE_NAME   = tempfile.mktemp(prefix="hp-pkservice-", suffix=".log")
 
         def __init__(self, connection=None, path='/', logfile=LOGFILE_NAME):
             if connection is None:
